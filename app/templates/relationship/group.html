{% extends "single_column.html" %}
{% from "macros.html" import renderInlineList, render_review, renderList, pagination, modal_render %}

{% block content_medium %}

{% set member = group in current_user.groups %}

<div class="card pb-0" id="user_profile">
    <div class="card-header p-3 clearfix">
            <div class="d-flex justify-content-center">
                <!-- filler for flexbox -->
                <h4>Profile Information</h4>
                {% if current_user.id == group.admin_id %}    
                    <a href="" class="btn btn-md btn-light ml-auto" data-toggle="modal" data-target="#groupUpdateForm">Edit</a>
                {% elif not member %}
                    <a href="{{url_for('relationship.groupadd', id=group.id)}}" class='btn btn-md btn-light float-right' role='button'>Join</a>
                {% endif %}
            </div>
    </div>
    <div class="card-body">
        {# Only show group members if user is group member #} 

        
            <dl class="row">
                    {{ renderInlineList("Name", (group.name))}}
                    {{ renderInlineList("Description", group.description)}}
                    {% if member %}
                        {{ renderInlineList("Admin - name", 
                        group.admin.first_name + " " + group.admin.last_name)}}
                    {% else %}    
                        {{ renderInlineList("Admin - username",
                                             group.admin.username) }}
                    {% endif %}
                    {{ renderInlineList("Admin - email", group.admin.email) }}                      
            </dl>

    </div>
</div>

    <br>

{% if member %}    
    <div class="card">
        <div class="card-header p-2">
            <h4 class="text-center"> Group Members </h4>
        </div>
        <div class="card-body pb-0">
            <ul>
                {% for member in group.members %}
                <li> <a href="{{url_for('main.user', username=member.username)}}">
                    {{ member.full_name}} </a></li>
                {% endfor %}
            </ul>
        </div>
    </div>
     <br>
{% endif %}     
{% endblock %}

{% block content_wide %}

{% endblock %}

{% block modal %}

    {% if modal_open %}
        <script>$(window).on('load', function(){
            $("#modal_id").modal('show');
        });
        </script>
    {% endif %}

    {% set url = url_for('relationship.groupUpdate') %}
    {% if modal_form %}
        {{modal_render(modal_form, modal_title, action=url, modalID="groupUpdateForm")}}
    {% endif %}

{% endblock%}
